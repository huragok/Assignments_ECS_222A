%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Structured General Purpose Assignment
% LaTeX Template
%
% This template has been downloaded from:
% http://www.latextemplates.com
%
% Original author:
% Ted Pavlic (http://www.tedpavlic.com)
%
% Note:
% The \lipsum[#] commands throughout this template generate dummy text
% to fill the template out. These commands should all be removed when 
% writing assignment content.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\usepackage{fancyhdr} % Required for custom headers
\usepackage{lastpage} % Required to determine the last page for the footer
\usepackage{extramarks} % Required for headers and footers
\usepackage{graphicx} % Required to insert images
\usepackage{lipsum} % Used for inserting dummy 'Lorem ipsum' text into the template
\usepackage{amsmath}
\usepackage{xcolor}
\usepackage{listings}
\usepackage[toc,page]{appendix}
\usepackage{algorithm}
\usepackage{algorithmic}

% Margins
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in 

\linespread{1.1} % Line spacing

% Set up the header and footer
\pagestyle{fancy}
\lhead{\hmwkAuthorName} % Top left header
\chead{\hmwkClass\ (\hmwkClassInstructor\ \hmwkClassTime): \hmwkTitle} % Top center header
\rhead{\firstxmark} % Top right header
\lfoot{\lastxmark} % Bottom left footer
\cfoot{} % Bottom center footer
\rfoot{Page\ \thepage\ of\ \pageref{LastPage}} % Bottom right footer
\renewcommand\headrulewidth{0.4pt} % Size of the header rule
\renewcommand\footrulewidth{0.4pt} % Size of the footer rule

\setlength\parindent{0pt} % Removes all indentation from paragraphs

%----------------------------------------------------------------------------------------
%	DOCUMENT STRUCTURE COMMANDS
%	Skip this unless you know what you're doing
%----------------------------------------------------------------------------------------

% Header and footer for when a page split occurs within a problem environment
\newcommand{\enterProblemHeader}[1]{
    \nobreak\extramarks{#1}{#1 continued on next page\ldots}\nobreak
    \nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
}

% Header and footer for when a page split occurs between problem environments
\newcommand{\exitProblemHeader}[1]{
    \nobreak\extramarks{#1 (continued)}{#1 continued on next page\ldots}\nobreak
    \nobreak\extramarks{#1}{}\nobreak
}

\setcounter{secnumdepth}{0} % Removes default section numbers
\newcounter{homeworkProblemCounter} % Creates a counter to keep track of the number of problems
\setcounter{homeworkProblemCounter}{-1}

\newcommand{\homeworkProblemName}{}
\newenvironment{homeworkProblem}[1][Problem \arabic{homeworkProblemCounter}]{ % Makes a new environment called homeworkProblem which takes 1 argument (custom name) but the default is "Problem #"
    \stepcounter{homeworkProblemCounter} % Increase counter for number of
% problems
    \renewcommand{\homeworkProblemName}{#1} % Assign \homeworkProblemName the
% name of the problem
    \section{\homeworkProblemName} % Make a section in the document with the
% custom problem count
    \enterProblemHeader{\homeworkProblemName} % Header and footer within the
% environment
}{
    \exitProblemHeader{\homeworkProblemName} % Header and footer after the
% environment
}

\newcommand{\problemAnswer}[1]{ % Defines the problem answer command with the content as the only argument
    \noindent\textbf{\emph{Answer: }}#1 % Just put a keyword Answer in
    % bold/italic at the beginning
}

\newcommand{\homeworkSectionName}{}
\newenvironment{homeworkSection}[1]{ % New environment for sections within homework problems, takes 1 argument - the name of the section
    \renewcommand{\homeworkSectionName}{#1} % Assign \homeworkSectionName to the
% name of the section from the environment argument
    \subsection{\homeworkSectionName} % Make a subsection with the custom name
% of the subsection
    \enterProblemHeader{\homeworkProblemName\ [\homeworkSectionName]} % Header
% and footer within the environment
}{
    \enterProblemHeader{\homeworkProblemName} % Header and footer after the
% environment
}

\newtheorem{theorem}{Theorem}[homeworkProblemCounter]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\newenvironment{proof}[1][Proof]{
    \begin{trivlist}
        \item[\hskip \labelsep {\bfseries #1}]
    }{
        \end{trivlist}
}
\newenvironment{definition}[1][Definition]{
    \begin{trivlist}
        \item[\hskip \labelsep {\bfseries #1}]
    }{
        \end{trivlist}
}
\newenvironment{example}[1][Example]{
    \begin{trivlist}
        \item[\hskip \labelsep {\bfseries #1}]
    }{
        \end{trivlist}
    }
\newenvironment{remark}[1][Remark]{
    \begin{trivlist}
        \item[\hskip \labelsep {\bfseries #1}]
    }{
        \end{trivlist}
}

\newcommand{\qed}{
    \nobreak \ifvmode \relax \else
    \ifdim\lastskip<1.5em \hskip-\lastskip
    \hskip1.5em plus0em minus0.5em \fi \nobreak
    \vrule height0.75em width0.5em depth0.25em\fi
}

\lstset{
    frame=single,
    breaklines=true,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\color{red}\hookrightarrow\space}}
}
   
%----------------------------------------------------------------------------------------
%	NAME AND CLASS SECTION
%----------------------------------------------------------------------------------------

\newcommand{\hmwkTitle}{Assignment\ \#1} % Assignment title
\newcommand{\hmwkDueDate}{Tusday,\ January\ 13,\ 2015} % Due date
\newcommand{\hmwkClass}{ECS\ 222A} % Course/class
\newcommand{\hmwkClassTime}{TR 4:40pm-6:00pm} % Class/lecture time
\newcommand{\hmwkClassInstructor}{Daniel Gusfield} % Teacher/lecturer
\newcommand{\hmwkAuthorName}{Wenhao Wu} % Your name

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title{
    \vspace{2in}
    \textmd{\textbf{\hmwkClass:\ \hmwkTitle}}\\
    \normalsize\vspace{0.1in}\small{Due\ on\ \hmwkDueDate}\\
    \vspace{0.1in}\large{\textit{\hmwkClassInstructor\ \hmwkClassTime}}
    \vspace{3in}
}

\author{\textbf{\hmwkAuthorName}}
\date{} % Insert date here if you want it to appear below your name

%----------------------------------------------------------------------------------------

\begin{document}

    \maketitle
    
    %----------------------------------------------------------------------------------------
    %	TABLE OF CONTENTS
    %----------------------------------------------------------------------------------------
    
    %\setcounter{tocdepth}{1} % Uncomment this line if you don't want subsections listed in the ToC
    
    \newpage
    \tableofcontents
    \newpage

    %----------------------------------------------------------------------------------------
    %	PROBLEM 0
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        In the bit-model every bit-level operation must be counted. For example,
        to take the OR of two binary strings of length $q$ each, takes $q$
        operations, and to use or set an index consisting of $q$ bits, takes $q$
        operations. Show in detail that in the bit-model, then the 4-Russianâ€™s
        method for bitmatrix multiplication only takes $\mathcal{O}(n^3/(\log
        n))$ operations.
        
        \problemAnswer{
            The steps of 4-Russian's method for bitmatrix multiplication (BMM)
            are as follows
            \begin{algorithm}
                \caption{4-Russian's algorithm for BMM of $n\times n$ bit matrix
                $A$ and $B$: C = AB}
                \label{alg:4russians}
                \begin{algorithmic}[1]
                    \STATE Define $k = \log_4 n$. Build a $2^k\times 2^k$ look
                    up tables $T$. $T(u, v)$ in which $u = 0,\ldots,2^k - 1$ and
                    $v = 0,\ldots,2^k-1$ is the multiplication between
                    the row bit vector representing $i$ and the column vit
                    vector representing $j$.
                    \FOR {i = 1 \TO n}
                        \FOR {j = 1 \TO n}
                            \STATE Divide $A$'s $i$-th row $A_{i,:}$ into $n/k$
                            row vectors of length $k$, denoted as
                            $A_{i,:}^{(1)}, \ldots, A_{i,:}^{(n/k)}$. Similarly,
                            divide $B$'s $j$-th row $B_{:, j}$ into $n/k$ column
                            vectors of length $k$, denoted as $B_{:,j}^{(1)},
                            \ldots, B_{:,j}^{(n/k)}$.
                            \STATE Lookup the multiplication value
                            $A_{i,:}^{(w)}B_{:,j}^{(w)}, w = 1,\ldots, n/k$, 
                            from table $T$.
                            \STATE Take the OR operation of all
                            $A_{i,:}^{(w)}B_{:,j}^{(w)}, w = 1,\ldots, n/k$ as
                            the result $C_{ij}$.
                        \ENDFOR
                    \ENDFOR
                \end{algorithmic}
            \end{algorithm}
            
            In line 1, to build the $2^k\times 2^k = \sqrt{n} \times
            \sqrt{n}$ lookup table, according to the matrix multiplication
            definition, it takes $\mathcal{O}(n^{3/2})$ operations
            
            In line 5, given $(i, j)$, for each $w$ it takes
            $\mathcal{O}(k)$ to index the table $T$, so the total number of cost
            of index is $\mathcal{O}(\log_4 n)$.
            
            In line 6, given $(i, j)$, the sum-OR takes
            $\mathcal{O}(n/k) = \mathcal{O}(n/\log_4 n)$ operations.
            
            Consequently, the total number of operations is 
            \[
                \mathcal{O}(n^{3/2}) + n^2(\mathcal{O}(\log_4 n) +
                \mathcal{O}(n/\log_4 n)) = \mathcal{O}(n^3/(\log(n)))
            \]
        
        }
    \end{homeworkProblem}
    
    %----------------------------------------------------------------------------------------
    %   PROBLEM 1
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        Prove that the edit distance is the same no matter which definition is
        used.
        
        \problemAnswer{
        }
    \end{homeworkProblem}
    
    %----------------------------------------------------------------------------------------
    %   PROBLEM 2
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        From the mathematical standpoint, an alignment and an edit transcript
        are equivalent ways to describe a relationship between two strings. An
        alignment can be easily converted to the equivalent edit transcript and
        vice-versa.  Completely explain and justify the above statement.
        
        \problemAnswer{
        }
    \end{homeworkProblem}
    
    %----------------------------------------------------------------------------------------
    %   PROBLEM 3
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        Prove that any traceback path specifies an optimal edit transcript, and
        an optimal alignment. In the latter case, explain how the path specifies
        where the spaces should go in the two strings.
        
        \problemAnswer{
        }
    \end{homeworkProblem}
    
    %----------------------------------------------------------------------------------------
    %   PROBLEM 4
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        \textbf{Theorem} Any path from $(n, m)$ to $(0, 0)$ following pointers
        established during the computation of $D(i, j)$ specifies an edit
        transcript with the minimum number of edit operations. Conversely, any
        optimal edit transcript is specified by such a path. Moreover, since a
        path describes only one transcript, the correspondence between paths and
        optimal transcripts is one-one.
        
        Prove this theorem.
        
        \problemAnswer{
        }
    \end{homeworkProblem}
    
    %----------------------------------------------------------------------------------------
    %   PROBLEM 5
    %----------------------------------------------------------------------------------------
    \begin{homeworkProblem}
        Since the traceback paths in a dynamic programming table correspond
        one-to-one with the optimal alignments, the number of distinct
        co-optimal alignments can be obtained by computing the number of
        distinct traceback paths. Give an algorithm to compute this number in
        $O(nm)$ time. Hint: use dynamic programming.

        \problemAnswer{
        }
    \end{homeworkProblem}
    %\clearpage

    
    %----------------------------------------------------------------------------------------

\end{document}